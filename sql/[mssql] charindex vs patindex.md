# [mssql] charindex vs patindex

문자열에서 특정 단어의 위치를 찾을 때에는 보통 **CHARINDEX**를 사용합니다.  
~~~sql
CHARINDEX('찾을단어','문자열', 시작위치)
~~~

PATINDEX는 정규식과 유사하게 **패턴**을 사용하여 문자열의 위치를 찾을 수 있습니다.  
또한 CHARINDEX의 경우에는 TEXT형식의 문자열을 검색할 수 없지만,  
**PATINDEX**는 **TEXT형식의 문자열과 함께 사용할 수 있기**때문에 유용합니다.  

## 기본 사용법
기본적으로 PATINDEX는 다음과 같이 사용합니다.  
~~~sql
PATINDEX('%찾을단어%','문자열')
~~~  
단어가 존재할 경우 첫번째 위치를 반환하고, 기본적으로 대소문자 구분은 하지 않습니다.  
만약 대소문자 구분을 하고싶다면 문자열뒤에 COLLATE 옵션을 사용합니다.  
~~~sql
PATINDEX('%찾을단어%','문자열' COLLATE Korean_Wansung_CS_AI)
~~~

## 패턴
패턴은 정규식처럼 사용할수있는 의미를 가지는 특수문자가 존재하여 이를 이용해서 작성하도록 합니다.  
| 패턴 | 의미    |
|------|---------|
|  %   | 0개 이상의 문자   |
|  _   | 임의의 한 문자     |
|  []  | 문자클래스(대괄호에 포함된 한 문자)     |
| [-]  | 문자 범위(0-9, a-z, 가-힣) |
| [^]  | 부정문자클래스 (대괄호에 포함되지 않은 문자) |

주의할점은 [ ] 문자열 클래스를 사용할 경우 대괄호에 들어가는 문자열은 개별문자로 인식된다는 점입니다.  
따라서 `%[cat]%` 은 `%c%` OR `%a%` OR `%t%` 와 같습니다.  

## 참고
[[MSSQL] PATINDEX함수 사용법 (패턴위치찾기)](gent.tistory.com/578)