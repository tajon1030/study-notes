# Backend 멀티쓰레드 이해하고 통찰력 키우기  
섹션3 : Multi-Thread에서 Multi Process로~ 통찰력 키우기(코드_c#)  

## Scale-Out과 SPOF - Backend의 맨 앞은 어떻게 생겼나?
### SPOF 단일실패지점
노드 하나가 망가지면 시스템 전체가 멈추는 지점  
해결책으로는 Replication, Cluster, Scale-Out

### 웹서버 스케일아웃
여러 웹서버에 유저들이 접근하도록 별도의 장치가 필요하다  

#### router
서로 다른 네트워크간 통신지원(비쌈)

#### switch
같은 네트워크안에서 통신지점(라우터보다쌈) (L1~L7)  
- L1(X) : 더미허브, 모두전송  
- L2(MAC) : 아이피모름, 스위칭허브, 정확한 목적지에만 전송  
- L3(IP) : 다른네트워크로 패킷전송가능(라우터기능)  
- L4(TCP/UDP) : 부하분산가능  
- L7(HTTP) : 프로토콜의 정보까지 인식하여 부하분산가능  

#### osi7계층
2,3,4,7은 외우자  
<img src = "https://github.com/tajon1030/study-notes/assets/60431816/481d4e53-f5c5-4de4-8d9c-83592b5fcb05" width="500" height="500">

#### 로드밸런서
부하분산을 해주는 부하분산장치를 통합하여 로드밸런서라고 부른다  
HA Proxy

로드밸런서 부하분산 : 로드밸런서도 하나만 두면 SPOF이기때문에 여러개를 둘수있는데 브라우저에서 로드밸런서는 어떻게 지정을 하는가?에 대한 질문

#### DNS RoundRobin
DNS내 도메인으로 여러 서버 IP를 넣을수있는데 여기에 LB들의 IP목록을 넣으면 된다.  
그러면 순번대로 돌아가며 DNS Resolve를 해줌(DNS를 보낼때 IP를 전달받는 과정을 DNS리졸빙이라고함)  

##### DNS RoundRobin 문제 1 
- DNS서버에서 특정 도메인으로 받는 IP는 일정기간동안 로컬PC에 설정한 TTL만큼 캐싱된다(로컬피씨에서 설정한 TTL이 아닌 도메인을 등록할때 TTL값을 설정할수있는데 그만큼 캐싱이 되서 도메인과 아이피 변경이 바로바로 적용이 되는것이 아님)  
- 다른 DNS서버들도 캐싱함  
- IP를 추가/삭제/변경하고 전파하는데 TTL시간만큼 걸려서 TTL시간을 짧게 만든다.

##### DNS RoundRobin 문제 2
- 단순히 순서대로 DNS에 등록되어있는 IP를 전달하기때문에 운이 나쁘면 특정 Node로 트래픽이 몰릴 수 있다.  

##### 더 좋은 DNS
DNS에서 설정된 로드밸런서의 헬스체크를 하는 기능  
글로벌서비스일때 위치기반으로 최적의 서버IP를 찾아줌  
IP별로 가중치를 두어 부하분산이 가능하고
AWS의 Route53

##### LB의 부하분산기준
- TCP Connection  
- Traffic  
- 가중치
- HTTP Request Count 특정시간동안 리퀘스트가 많은쪽은 덜보내주고 이런것들..

## MySql 파헤치기 - 어려운 부분만 부분 쉽게 설명해 줄게요

## Kafka 파헤치기 - Multi Thread 지식이 있다면 분석 무섭지 않다


