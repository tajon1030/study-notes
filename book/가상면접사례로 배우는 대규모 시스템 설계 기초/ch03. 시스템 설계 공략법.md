# 가상 면접 사례로 배우는 대규모 시스템 설계 기초

## chapter 3. 시스템 설계면접 공략법
시스템 설계 면접은 동료가 모호한 문제를 풀기 위해 협력하여 해결책을 찾아내는 과정에 대한 시뮬레이션  
효과적인 면접을 위한 4단계 접근법을 따라가며 설계해보자.  

### 1. 문제 이해 및 설계 범위 확정
답부터 들이밀지 말고 깊이 생각하고 질문하여 요구사항과 가정들을 분명히 하라.  
시스템 구축에 필요한 정보를 모으자.  

#### 요구사항을 정확히 이해하는데 필요한 질문의 예
- 구체적으로 어떤 기능들을 만들어야 하는지
- 제품 사용자 수는 얼마나 되는지
- 회사의 규모는 얼마나 빨리 커지리라 예상하는지(석달/여섯달/일년뒤의 규모)
- 회사가 주로 사용하는 기술스택은? 설계를 단순화하기위해 활용할 수 있는 기존 서비스로는 어떤것들이 있는지?

### 2. 개략적인 설계안 제시 및 동의 구하기
면접관과 협력하여 계략적인 설계안에 대해 동의를 얻는다.  
- 최초 청사진을 제시하고 의견을 구하기  
- 핵심 컴포넌트를 포함하는 다이어그램을 그리기  
크라이언트, API, 웹서버, DB, 캐시, CDN, 메시지 큐 등이 포함될 수 있을것이다.  
- 개략적 추정이 필요한지 면접관에게 미리 물어보고  
최초 설계안이 규모와 관련된 제약사항을 만족하는지 개략적으로 소리내어 설명하기
- 구체적 사용 사례도 몇가지 살펴보면 개략적 설계안을 잡아나가는데 도움이 될것이고,  
고려하지못한 엣지케이스를 발견하는데에도 도움이 될 것 이다. 
- 상황에따라 구글검색엔진설계같은 문제라면 엔드포인트나 DB스키마를 보여주기에는 세부적일것이나  
멀티플레이어 포커게임의 백엔드를 설계하라는 질문이면 괜찮을 것이므로 면접관의 의견을 물어보자  

### 3. 상세설계
설계대상 컴포넌트사이의 우선순위 정하기  
대부분의 경우 특정 시스템 컴포넌트들의 세부사항을 깊이있게 설명하는 것을 보길 원한다.  
- 단축 URL 설계기 -> 해시함수 설계에 대한 내용  
- 채팅시스템 -> 지연시간을 줄이고 어떻게 온오프를 표시할 것인지  
불필요한 세부사항에는 시간을 쓰지 말아라  ex) 뉴스피드순위매기는데 사용하는 엣지랭크알고리즘...

### 4. 마무리
설계에 대한 몇가지 후속질문과 스스로의 논의를 진행하기  
- 시스템 병목구간이나 개선가능한 지점이 없다고 말하지 않기
- 설계를 다시한번 요약하기  
- 오류가 발생한다면 어떤 오류가 발생할것인지 따져보기(서버/네트워크장애 등)
- 운영이슈 논의(매트릭 수집/모니터링/로그/배포방식)  
- 현재 백만일경우 미래 천만일경우를 감당가능한가? 어떻게하면 감당가능하게 될까?
- 세부적 개선사항 제안해보기


### 예시를 통해 알아보기 - 뉴스피드 설계
#### 1. 설계 요구
모바일앱과 웹앱가운데 어느쪽을 지원해야하는가?  
가장 중요한 기능은?  
피드는 시간역순으로 정렬되어야하는지 아니면 다른 특별한 정렬기준이 있는지  
정렬에 대해 물어본 이유는 피드에 올라갈때마다 포스트마다 다른 가중치가 부여되어야하는지 알아야한다.  
예를들어 가장 가까운 친구의 포스트가 사용자 그룹에 올라가는 포스트보다 더 중요한다던가...  
한 사용자는 최대 몇명의 사용자와 친구를 맺을 수 있는가?  
사이트로 오는 트래픽 규모는 어느정도인가  
피드에 이미지나 비디오도 올라올수있는가 아니면 텍스트뿐인가  

#### 2. 개략적 설계
개략적으로 두가지 처리플로우 : 피드발행/생성  
- 피드발행 : 사용자가 포스트를 올리면 관련데이터가 캐시/디비에 기록되고 사용자의 친구 뉴스피드에 뜨게된다.  
- 피드생성 : 사용자의 뉴스피드는 친구들의 포스트를 시간역순으로 정렬하여 만든다.  

<img src="https://github.com/tajon1030/study-notes/assets/60431816/9cb38979-0eef-49c2-ac35-8b541e8c36cf" width="700" height="500">


#### 3. 상세설계
<img src="https://github.com/tajon1030/study-notes/assets/60431816/ab151999-196b-41b6-a815-8b28009f5c74" width="700" height="500">


### 면접세션 해야할것 정리
- 질문을 통해 확인하라
- 요구사항을 이해하라
- 정답은 없다
- 면접관이 나(면접자)의 사고흐름을 이해할수있도록 소통하라.
- 여러해법을 함께 제시하라
- 개략적 설계에 동의하면 세부사항을 설명하고, 가장 중요한 컴포넌트부터 진행
- 면접관의 아이디어를 이끌어내라(진행중 막혔다면 힌트 청하기)
- 포기하지 말라

### 면접세션 하지말아야할것 정리
- 요구사항을 분명히 하지 않은상태에서 설계 제시하지 말것
- 처음부터 세부사항 너무 깊게 설명X
- 침묵은 금물 소통을 주저하지말것
- 의견을 일찍 자주 구하라

### 시간배분
1단계 문제이해/설계범위확정 3 - 10분  
2단계 개략설계안 제시 및 동의구하기 10 - 15분  
3단계 상세설계 10 - 25분  
4단계 마무리 3-5분  


