5월 식품들의 총매출 조회하기
  
FOOD_PRODUCT와 FOOD_ORDER 테이블에서 생산일자가 2022년 5월인 식품들의 식품 ID, 식품 이름, 총매출을 조회하는 SQL문을 작성해주세요. 이때 결과는 총매출을 기준으로 내림차순 정렬해주시고 총매출이 같다면 식품 ID를 기준으로 오름차순 정렬해주세요.  

### 내가 쓴 풀이  
~~~sql
SELECT PRODUCT.PRODUCT_ID,
      PRODUCT.PRODUCT_NAME,
      SUM(AMOUNT) * PRICE AS TOTAL_SALES
FROM FOOD_PRODUCT AS PRODUCT
JOIN FOOD_ORDER ON PRODUCT.PRODUCT_ID = FOOD_ORDER.PRODUCT_ID
AND PRODUCE_DATE LIKE '2022-05%'
GROUP BY PRODUCT.PRODUCT_ID
ORDER BY TOTAL_SALES DESC, PRODUCT_ID
~~~

### 다른 풀이법  
~~~sql
SELECT FP.PRODUCT_ID, FP.PRODUCT_NAME, SUM(FP.PRICE * FO.AMOUNT) AS TOTAL_SALES 
FROM FOOD_PRODUCT FP 
JOIN FOOD_ORDER FO ON FP.PRODUCT_ID = FO.PRODUCT_ID
WHERE DATE_FORMAT(FO.PRODUCE_DATE, '%Y%m') = '202205'
GROUP BY PRODUCT_ID
ORDER BY TOTAL_SALES DESC, FP.PRODUCT_ID;
~~~  
DATE_FORMAT을 사용하는 방식  

~~~sql
SELECT p.product_id, p.product_name, sum(P.price*O.AMOUNT) as total_sales  
from FOOD_PRODUCT P
JOIN FOOD_ORDER O ON P.PRODUCT_ID=O.PRODUCT_ID
WHERE O.PRODUCE_DATE BETWEEN '2022-05-01' AND '2022-05-31'
GROUP BY P.PRODUCT_ID,P.PRODUCT_NAME
ORDER BY 3 DESC, 1;
~~~  
BETWEEN을 사용할 수 있다.  

~~~sql
SELECT PRODUCT_ID, PRODUCT_NAME, PRICE*AMOUNT AS TOTAL_SALES
FROM FOOD_PRODUCT AS P 
JOIN (SELECT PRODUCT_ID, SUM(AMOUNT) AS AMOUNT
            FROM FOOD_ORDER
            WHERE MONTH(PRODUCE_DATE) = '05' AND  YEAR(PRODUCE_DATE) = '2022' 
            GROUP BY PRODUCT_ID) AS O USING (PRODUCT_ID)
ORDER BY TOTAL_SALES DESC, PRODUCT_ID ASC
~~~

1. ID를 기준 5월의 총 판매량 계산
2. 계산한 테이블과 FOOD_PRODUCT 테이블 JOIN
3. 조건에 해당하도록 정렬하여 가격 계산 컬럼 출력